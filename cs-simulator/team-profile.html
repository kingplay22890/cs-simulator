<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ü—Ä–æ—Ñ–∏–ª—å –∫–æ–º–∞–Ω–¥—ã</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-gray-900 text-white p-6 min-h-screen">

<div class="max-w-4xl mx-auto">

  <!-- Select –æ—Å—Ç–∞—ë—Ç—Å—è —Å–≤–µ—Ä—Ö—É -->
  <select id="teamSelect" class="w-full p-3 bg-gray-800 rounded-lg mb-6 text-lg border border-gray-700/50 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition">
    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É</option>
  </select>

  <!-- –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É –ø—Ä–æ—Ñ–∏–ª—è + –∏—Å—Ç–æ—Ä–∏—è –≤ #profile (–±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
  <div id="profile" class="hidden">
    <div class="bg-gradient-to-br from-gray-800/90 to-gray-900/90 rounded-xl p-6 mb-6 border border-gray-700/50 shadow-xl">
      <div class="flex items-center gap-4 mb-4">
        <img id="teamLogo" class="w-16 h-16 rounded-lg shadow-lg ring-2 ring-blue-500/30" src="https://via.placeholder.com/64" alt="logo">
        <div>
          <h1 id="teamName" class="text-2xl font-bold inline bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent"></h1><button id="editProfileBtn" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å" class="ml-2 text-xl align-middle hover:scale-110 transition">‚úèÔ∏è</button>
          <p class="text-blue-400 font-semibold"><span id="teamRank"></span> ‚Ä¢ <span id="teamRating"></span></p>
          <div id="teamCountry" class="text-sm text-gray-400 mt-1"></div>
        </div>
      </div>

        <!-- –ë–∞–Ω–Ω–µ—Ä –∏–≥—Ä–æ–∫–æ–≤ –∫–∞–∫ –Ω–∞ HLTV -->
        <div id="playerBanner" class="grid grid-cols-5 gap-4 items-end justify-items-center pb-4 mb-2 border-b border-gray-700"></div>
        <!-- –ë–ª–æ–∫ –Ω–∞–≥—Ä–∞–¥/–∫—É–±–∫–æ–≤ -->
        <div class="bg-gray-800 rounded-xl p-4 mb-4">
          <div class="flex items-center mb-2">
            <h2 class="text-xl font-bold">–ù–∞–≥—Ä–∞–¥—ã</h2>
            <button id="addAwardBtn" class="hidden ml-2 text-xl text-yellow-400 hover:text-yellow-300" title="–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–æ—Ñ–µ–π">‚ûï</button>
          </div>
          <div id="awardsList" class="flex flex-wrap gap-4"></div>
        </div>
      <div class="grid grid-cols-3 gap-4 text-center">
        <div class="bg-gray-700 p-4 rounded">
          <p class="text-sm text-gray-400">–†–µ–π—Ç–∏–Ω–≥ (5 –º–∞—Ç—á–µ–π)</p>
          <p id="ratingChange" class="text-2xl font-bold">+0</p>
        </div>
        <div class="bg-gray-700 p-4 rounded">
          <p class="text-sm text-gray-400">–ú–µ—Å—Ç–æ</p>
          <p class="text-2xl font-bold"><span id="teamPlace">_</span></p>
        </div>
        <div class="bg-gray-700 p-4 rounded relative overflow-hidden">
          <div class="winrate-slider-container">
            <div class="winrate-slide winrate-slide-active" data-slide="recent">
              <p class="text-sm text-gray-400">Win Rate (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 15)</p>
              <p id="winRateRecent" class="text-2xl font-bold">0%</p>
            </div>
            <div class="winrate-slide" data-slide="all">
              <p class="text-sm text-gray-400">Win Rate (<span id="totalMatches">0</span> –º–∞—Ç—á–µ–π)</p>
              <p id="winRate" class="text-2xl font-bold">0%</p>
            </div>
          </div>
          <div class="winrate-slider-controls">
            <button class="winrate-slider-btn winrate-slider-btn-left" data-target="recent" title="–ü–æ—Å–ª–µ–¥–Ω–∏–µ 15 –º–∞—Ç—á–µ–π">‚Üê</button>
            <button class="winrate-slider-btn winrate-slider-btn-right" data-target="all" title="–í—Å–µ –º–∞—Ç—á–∏">‚Üí</button>
          </div>
        </div>
      </div>
    </div>
    <div class="bg-gradient-to-br from-gray-800/90 to-gray-900/90 rounded-xl p-6 mb-6 border border-gray-700/50 shadow-xl">
      <h2 class="text-2xl font-bold mb-6 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">–°–æ—Å—Ç–∞–≤</h2>
      <div id="roster" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
    </div>
    <div class="bg-gradient-to-br from-gray-800/90 to-gray-900/90 rounded-xl p-6 mb-6 border border-gray-700/50 shadow-xl">
      <h3 class="text-2xl font-bold mb-4 bg-gradient-to-r from-orange-400 to-yellow-400 bg-clip-text text-transparent">World Ranking Development</h3>
      <div id="peakInfo" class="mb-4 text-orange-400 font-semibold"></div>
      <div class="chart-container">
        <canvas id="rankingChart"></canvas>
      </div>
    </div>
    <div class="bg-gradient-to-br from-gray-800/90 to-gray-900/90 rounded-xl p-6 mb-6 border border-gray-700/50 shadow-xl">
      <!-- –ö–∞—Ä—Ç—ã -->
      <div id="mapStatsSection" class="space-y-5 hidden">
        <div class="flex items-center justify-between">
          <h2 class="text-2xl font-bold bg-gradient-to-r from-sky-400 to-emerald-400 bg-clip-text text-transparent">MAPS</h2>
          <div id="mapTotalCount" class="text-sm text-gray-400"></div>
        </div>
        <div id="mapHighlights" class="space-y-2 mb-6"></div>
        <div id="mapCards" class="space-y-0"></div>
      </div>
    </div>
    <div class="bg-gradient-to-br from-gray-800/90 to-gray-900/90 rounded-xl p-6 border border-gray-700/50 shadow-xl">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">–ò—Å—Ç–æ—Ä–∏—è –º–∞—Ç—á–µ–π</h2>
        <button id="toggleHistoryBtn" class="text-sm text-blue-400 hover:text-blue-300 transition">
          <span id="historyToggleText">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ</span>
        </button>
      </div>
      <div id="historyContainer">
        <table class="w-full text-sm history-table">
          <thead>
            <tr>
              <th class="p-3 text-left">–î–∞—Ç–∞</th>
              <th class="p-3 text-left">–°–æ–ø–µ—Ä–Ω–∏–∫</th>
              <th class="p-3 text-left">–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
              <th class="p-3 text-left">–°—á—ë—Ç</th>
              <th class="p-3 text-left">Œî –†–µ–π—Ç–∏–Ω–≥</th>
            </tr>
          </thead>
          <tbody id="historyBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–ª–∞–¥–∫–∏ -->
  <div class="mt-4">
    <button onclick="debugTeamData()" class="bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded transition">
      –û—Ç–ª–∞–¥–∫–∞
    </button>
  </div>

</div>

<!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø -->
<div id="editTeamModal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4">
  <div class="bg-gray-800 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-gray-700">
    <div class="sticky top-0 bg-gray-900 border-b border-gray-700 p-6 flex items-center justify-between">
      <h2 class="text-2xl font-bold text-white">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã</h2>
      <button onclick="closeEditTeamModal()" class="text-gray-400 hover:text-white text-2xl">‚úï</button>
    </div>

    <div class="p-6 space-y-6">
      <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã -->
      <div>
        <label class="block text-sm font-semibold text-gray-300 mb-2">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã</label>
        <input id="editTeamName" type="text" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition">
      </div>

      <!-- –õ–æ–≥–æ—Ç–∏–ø -->
      <div>
        <label class="block text-sm font-semibold text-gray-300 mb-2">URL –ª–æ–≥–æ—Ç–∏–ø–∞</label>
        <input id="editTeamLogo" type="text" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition" placeholder="https://...">
        <div id="logoPreview" class="mt-3 h-16 w-16 rounded-lg bg-gray-700 flex items-center justify-center text-gray-500">
          <img id="logoPreviewImg" class="max-h-full max-w-full rounded" alt="preview">
        </div>
      </div>

      <!-- –°—Ç—Ä–∞–Ω–∞/–†–µ–≥–∏–æ–Ω -->
      <div>
        <label class="block text-sm font-semibold text-gray-300 mb-2">–°—Ç—Ä–∞–Ω–∞/–†–µ–≥–∏–æ–Ω</label>
        <select id="editTeamCountry" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition">
          <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É</option>
        </select>
      </div>

      <!-- –ò–≥—Ä–æ–∫–∏ -->
      <div>
        <div class="flex items-center justify-between mb-3">
          <label class="block text-sm font-semibold text-gray-300">–°–æ—Å—Ç–∞–≤</label>
          <button onclick="addPlayerRow()" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm transition">
            + –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞
          </button>
        </div>
        <div id="playersList" class="space-y-3">
          <!-- –°—Ç—Ä–æ–∫–∏ –∏–≥—Ä–æ–∫–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ -->
        </div>
      </div>

      <!-- –¢—Ä–æ—Ñ–µ–∏/–ù–∞–≥—Ä–∞–¥—ã -->
      <div>
        <div class="flex items-center justify-between mb-3">
          <label class="block text-sm font-semibold text-gray-300">–¢—Ä–æ—Ñ–µ–∏</label>
          <button onclick="addTrophyRow()" class="bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 rounded text-sm transition">
            + –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–æ—Ñ–µ–π
          </button>
        </div>
        <div id="trophiesList" class="space-y-3">
          <!-- –°—Ç—Ä–æ–∫–∏ —Ç—Ä–æ—Ñ–µ–µ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ -->
        </div>
      </div>

      <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
      <div class="flex gap-3 pt-4 border-t border-gray-700">
        <button onclick="saveTeamEdit()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition">
          ‚úì –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
        </button>
        <button onclick="closeEditTeamModal()" class="flex-1 bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded transition">
          –û—Ç–º–µ–Ω–∞
        </button>
      </div>
    </div>
  </div>
</div>

<!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –¢–†–ê–ù–°–§–ï–†–û–í -->
<div id="transferModal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4">
  <div class="bg-gray-800 rounded-xl max-w-xl w-full border border-gray-700">
    <div class="bg-gray-900 border-b border-gray-700 p-6 flex items-center justify-between">
      <h2 class="text-2xl font-bold text-white">–¢—Ä–∞–Ω—Å—Ñ–µ—Ä –∏–≥—Ä–æ–∫–∞</h2>
      <button onclick="closeTransferModal()" class="text-gray-400 hover:text-white text-2xl">‚úï</button>
    </div>

    <div class="p-6 space-y-4">
      <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–≥—Ä–æ–∫–µ -->
      <div class="bg-gray-700 p-4 rounded">
        <p class="text-gray-400 text-sm">–ò–≥—Ä–æ–∫</p>
        <p id="transferPlayerName" class="text-xl font-bold text-white"></p>
      </div>

      <!-- –í—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è -->
      <div>
        <label class="block text-sm font-semibold text-gray-300 mb-3">–î–µ–π—Å—Ç–≤–∏–µ</label>
        <div class="space-y-2">
          <button onclick="selectTransferAction('bench')" class="w-full p-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded font-semibold transition text-left" id="actionBench">
            ü™ë –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ BENCHED
          </button>
          <button onclick="selectTransferAction('transfer')" class="w-full p-3 bg-purple-600 hover:bg-purple-700 text-white rounded font-semibold transition text-left" id="actionTransfer">
            üîÑ –¢—Ä–∞–Ω—Å—Ñ–µ—Ä –≤ –¥—Ä—É–≥—É—é –∫–æ–º–∞–Ω–¥—É
          </button>
        </div>
      </div>

      <!-- –í—ã–±–æ—Ä –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞ (—Å–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
      <div id="transferTeamSelect" class="hidden">
        <label class="block text-sm font-semibold text-gray-300 mb-2">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É</label>
        <select id="destinationTeam" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:border-blue-500">
          <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É --</option>
        </select>
      </div>

      <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
      <div class="flex gap-3 pt-4 border-t border-gray-700">
        <button onclick="confirmTransfer()" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded transition">
          ‚úì –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
        </button>
        <button onclick="closeTransferModal()" class="flex-1 bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded transition">
          –û—Ç–º–µ–Ω–∞
        </button>
      </div>
    </div>
  </div>
</div>

<!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–ï–¢–ê–õ–¨–ù–û–ô –°–¢–ê–¢–ò–°–¢–ò–ö–ò –ú–ê–¢–ß–ê -->
<div id="matchDetailsModal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto">
  <div class="bg-gradient-to-br from-gray-800/95 to-gray-900/95 rounded-xl max-w-6xl w-full max-h-[95vh] overflow-y-auto border border-gray-700/50 shadow-2xl my-8">
    <div class="sticky top-0 bg-gradient-to-r from-gray-800 to-gray-900 border-b border-gray-700/50 p-6 flex items-center justify-between backdrop-blur-sm z-10">
      <h2 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞—Ç—á–∞</h2>
      <button onclick="closeMatchDetailsModal()" class="text-gray-400 hover:text-white text-3xl font-bold transition">‚úï</button>
    </div>
    <div id="matchDetailsContent" class="p-6">
      <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
    </div>
  </div>
</div>

<!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ò–°–¢–û–†–ò–ò –ú–ê–¢–ß–ï–ô –ü–û –ö–ê–†–¢–ï -->
<div id="mapHistoryModal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto">
  <div class="bg-gradient-to-br from-gray-800/95 to-gray-900/95 rounded-xl max-w-4xl w-full max-h-[95vh] overflow-y-auto border border-gray-700/50 shadow-2xl my-8">
    <div class="sticky top-0 bg-gradient-to-r from-gray-800 to-gray-900 border-b border-gray-700/50 p-6 flex items-center justify-between backdrop-blur-sm z-10">
      <div>
        <h2 class="text-2xl font-bold bg-gradient-to-r from-sky-400 to-emerald-400 bg-clip-text text-transparent" id="mapHistoryTitle">–ò—Å—Ç–æ—Ä–∏—è –º–∞—Ç—á–µ–π</h2>
        <p id="mapHistoryStats" class="text-sm text-gray-400 mt-2"></p>
      </div>
      <button onclick="closeMapHistoryModal()" class="text-gray-400 hover:text-white text-3xl font-bold transition">‚úï</button>
    </div>
    <div class="p-6">
      <div id="mapHistoryTable" class="space-y-3">
        <!-- –¢–∞–±–ª–∏—Ü–∞ –º–∞—Ç—á–µ–π –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–¥–µ—Å—å -->
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/config.js"></script>
<script src="js/api.js"></script>
<script src="js/map-utils.js"></script>
<script src="js/countries.js"></script>
<script src="js/player-awards-store.js"></script>
<script src="js/team-profile.js"></script>
<script src="js/winrate-slider.js"></script>
</body>
</html>
